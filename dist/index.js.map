{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["import {useEffect, useRef, useState} from \"react\";\r\n\r\nexport const useDocumentVisibility = () => {\r\n\r\n    const [visible, setVisible] = useState(!document.hidden)\r\n    const [count, setCount] = useState(0)\r\n\r\n    const visiblePage = () => {\r\n        console.log(subsribers)\r\n        if (document.hidden) {\r\n            func('isVisible', 'hidden')\r\n            setVisible(false)\r\n            setCount(prevCount => prevCount + 1)\r\n        } else {\r\n            func('isVisible', 'visible')\r\n            setVisible(true)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        document.addEventListener('visibilitychange', visiblePage)\r\n        return () => document.removeEventListener('visibilitychange', visiblePage)\r\n    }, [])\r\n\r\n    const subsribers = useRef<{isVisible: Array<(data: string)=>void>}>({\r\n        'isVisible': []\r\n    })\r\n\r\n    const onVisibilityChange = (callback: (data: string)=>void) => {\r\n        subsribers.current.isVisible.push(callback);\r\n    }\r\n\r\n    const func = (name: 'isVisible', data: string) => {\r\n        if (subsribers.current[name]) {\r\n            for (let callback of subsribers.current[name]) {\r\n                callback(data);\r\n            }\r\n        }\r\n    }\r\n\r\n    return {onVisibilityChange, visible, count}\r\n}"],"names":["_useState","useState","document","hidden","visible","setVisible","_useState2","count","setCount","visiblePage","console","log","subsribers","func","prevCount","useEffect","addEventListener","removeEventListener","useRef","isVisible","name","data","current","_step","_iterator","_createForOfIteratorHelperLoose","done","callback","value","onVisibilityChange","push"],"mappings":"+JAEqC,WAEjC,IAAAA,EAA8BC,EAAAA,UAAUC,SAASC,QAA1CC,EAAPJ,EAAA,GAAgBK,EAChBL,EAAA,GAAAM,EAA0BL,EAAQA,SAAC,GAA5BM,EAAPD,EAAA,GAAcE,EAEdF,EAAA,GAAiBG,EAAG,WAChBC,QAAQC,IAAIC,GACRV,SAASC,QACTU,EAAK,YAAa,UAClBR,GAAW,GACXG,EAAS,SAAAM,GAAaA,OAAAA,EAAY,CAAhB,KAElBD,EAAK,YAAa,WAClBR,GAAW,GAElB,EAEDU,EAASA,UAAC,WAEN,OADAb,SAASc,iBAAiB,mBAAoBP,GACvC,WAAA,gBAAeQ,oBAAoB,mBAAoBR,EAAvD,CACV,EAAE,IAEH,IAAMG,EAAaM,EAAMA,OAA2C,CAChEC,UAAa,OAOJ,SAACC,EAAmBC,GAC7B,GAAIT,EAAWU,QAAQF,GACnB,IAAA,IAAAG,EAAAC,2qBAAAC,CAAqBb,EAAWU,QAAQF,MAAxCG,EAAAC,KAAAE,OACIC,EAD2CJ,EAAAK,OAClCP,EAGpB,EAED,MAAO,CAACQ,mBAZmB,SAACF,GACxBf,EAAWU,QAAQH,UAAUW,KAAKH,EACrC,EAU2BvB,QAAAA,EAASG,MAAAA,EACxC"}