{"version":3,"file":"index.modern.mjs","sources":["../src/index.ts"],"sourcesContent":["import {useEffect, useRef, useState} from \"react\";\r\n\r\nexport const useDocumentVisibility = () => {\r\n\r\n    const [visible, setVisible] = useState(!document.hidden)\r\n    const [count, setCount] = useState(0)\r\n\r\n    const visiblePage = () => {\r\n        console.log(subsribers)\r\n        if (document.hidden) {\r\n            func('isVisible', 'hidden')\r\n            setVisible(false)\r\n            setCount(prevCount => prevCount + 1)\r\n        } else {\r\n            func('isVisible', 'visible')\r\n            setVisible(true)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        document.addEventListener('visibilitychange', visiblePage)\r\n        return () => document.removeEventListener('visibilitychange', visiblePage)\r\n    }, [])\r\n\r\n    const subsribers = useRef<{isVisible: Array<(data: string)=>void>}>({\r\n        'isVisible': []\r\n    })\r\n\r\n    const onVisibilityChange = (callback: (data: string)=>void) => {\r\n        subsribers.current.isVisible.push(callback);\r\n    }\r\n\r\n    const func = (name: 'isVisible', data: string) => {\r\n        if (subsribers.current[name]) {\r\n            for (let callback of subsribers.current[name]) {\r\n                callback(data);\r\n            }\r\n        }\r\n    }\r\n\r\n    return {onVisibilityChange, visible, count}\r\n}"],"names":["useDocumentVisibility","visible","setVisible","useState","document","hidden","count","setCount","console","log","subsribers","func","prevCount","useEffect","addEventListener","visiblePage","removeEventListener","useRef","isVisible","name","data","current","callback","onVisibilityChange","push"],"mappings":"4DAEaA,QAAwB,KAEjC,MAAOC,EAASC,GAAcC,GAAUC,SAASC,SAC1CC,EAAOC,GAAYJ,EAAS,KAEf,KAChBK,QAAQC,IAAIC,GACRN,SAASC,QACTM,EAAK,YAAa,UAClBT,GAAW,GACXK,EAASK,GAAaA,EAAY,KAElCD,EAAK,YAAa,WAClBT,GAAW,GACd,EAGLW,EAAU,KACNT,SAASU,iBAAiB,mBAAoBC,GACvC,IAAMX,SAASY,oBAAoB,mBAAoBD,IAC/D,IAEH,MAAML,EAAaO,EAAiD,CAChEC,UAAa,OAOJ,CAACC,EAAmBC,KAC7B,GAAIV,EAAWW,QAAQF,GACnB,IAAK,IAAIG,KAAYZ,EAAWW,QAAQF,GACpCG,EAASF,EAEhB,EAGL,MAAO,CAACG,mBAZoBD,IACxBZ,EAAWW,QAAQH,UAAUM,KAAKF,EAAlC,EAWwBrB,UAASK,QAA9B"}